var searchfield=document.getElementById("search");var sugbox=document.getElementById("searchsuggestions");var queries=new Array();var suggestions=new Array();var searchValue;var hoveredSuggestion=-1;function buildSearch(E){if(document.cookie.indexOf("lastsearches=")!=-1){var A=document.cookie.substring(document.cookie.indexOf("lastsearches=")+13)+";";var C=A.substring(0,A.indexOf(";"));cookieQueries=C.split("|")}else{cookieQueries=new Array()}for(var B=0;B<cookieQueries.length;B++){cookieQueries[B]=unescape(cookieQueries[B]);var D=E.indexOf(cookieQueries[B]);if(D!=-1){E.splice(D,1)}}queries=cookieQueries.concat(E);searchfield.setAttribute("autocomplete","off");searchfield.onkeydown=function(F){try{searchKeyDown(event.keyCode)}catch(G){searchKeyDown(F.keyCode)}};searchfield.onkeyup=function(F){try{searchKeyUp(event.keyCode)}catch(G){searchKeyUp(F.keyCode)}};searchfield.onblur=function(){setTimeout(hideSugbox,250)}}function hoverSuggestion(A){for(var B=0;B<suggestions.length;B++){sugbox.getElementsByTagName("a")[B].className=""}if(A!=-1){sugbox.getElementsByTagName("a")[A].className="hovered";hoveredSuggestion=A}}function searchKeyDown(A){if(sugbox.style.display=="block"){if(A!=38&&A!=40){hoveredSuggestion=-1}if(A==38&&hoveredSuggestion!=-1){hoveredSuggestion--;hoverSuggestion(hoveredSuggestion);searchfield.value=suggestions[hoveredSuggestion]}if(A==40&&hoveredSuggestion<suggestions.length-1){hoveredSuggestion++;hoverSuggestion(hoveredSuggestion);searchfield.value=suggestions[hoveredSuggestion]}if(A==38&&hoveredSuggestion==-1){searchfield.value=searchValue}}}function searchKeyUp(A){if(A!=38&&A!=40){searchValue=searchfield.value}if(searchfield.value!=""&&A!=13&&A!=27&&A!=38&&A!=40){giveSuggestions()}if((searchfield.value==""||A==27)&&sugbox.style.display=="block"){hideSugbox()}}function giveSuggestions(){suggestions=new Array();for(var A=0;A<queries.length&&suggestions.length<10;A++){if(queries[A].indexOf(searchfield.value.toLowerCase())==0){suggestions.push(queries[A])}}for(var A=0;A<queries.length&&suggestions.length<10;A++){if(queries[A].indexOf(searchfield.value.toLowerCase())>0){suggestions.push(queries[A])}}if(suggestions.length==0){hideSugbox()}else{showSugbox()}sugbox.innerHTML="";for(var A=0;A<suggestions.length;A++){sugbox.innerHTML+='<a href="/search/?search='+suggestions[A]+'" style="width:'+(searchfield.offsetWidth-6)+'px;" onmouseover="hoverSuggestion('+A+')">'+suggestions[A]+"</a>"}}function showSugbox(){sugbox.style.top=(realOffset(searchfield,"offsetTop")+searchfield.offsetHeight-1)+"px";sugbox.style.left=realOffset(searchfield,"offsetLeft")+"px";sugbox.style.width=(searchfield.offsetWidth-2)+"px";sugbox.style.display="block"}function hideSugbox(){sugbox.style.display="none"};